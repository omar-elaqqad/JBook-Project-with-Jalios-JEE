!(function(h){const m=32;if(!h.jalios){h.jalios={}}var v=/ajax-refresh/i;var w=h.jalios.Properties.get("ajax-refresh-setup");var b=function(A,B){if(!B){A.removeClass("ajax-refresh-debug");return}if(h(document.location).prop("href").indexOf("debug=true")>=0){A.addClass("ajax-refresh-debug")}};var t=function(C,A,B){if(B.nofocus||B.noscroll){return}let oTop=A.offset().top;let $window=h(window);let $topbarPlaceholder=h(".topbar-placeholder");let topbarHeight=$topbarPlaceholder.exists()?$topbarPlaceholder.height():0;let wTop=$window.scrollTop()+topbarHeight;let wHeight=$window.height();if(wTop<oTop&&oTop<wTop+$window.height()){return}let newPosition=oTop-10;if(topbarHeight){newPosition-=topbarHeight}h("html,body").animate({scrollTop:newPosition},"fast")};var e=function(A,C,B){if(!C){A.removeData("ajax-refresh:job");if(B&&B.waiting){A.removeClass("ajax-refresh-job")}return true}if(A.data("ajax-refresh:job")){return false}A.data("ajax-refresh:job",true);if(B.waiting&&h.fn.displayLoadingWaves){A.addClass("ajax-refresh-job")}return true};const z=function(A,B){this.message=A;this.name="AjaxRefreshException";console.debug(B)};var o='<div class="ajax-lazy-load">';var a=function(D,E){D=h.jalios.Common.strip(D,true);var H="";var C=D.indexOf(o);if(C>0){H=D.substring(C+o.length,D.lastIndexOf("</div>"));D=D.substring(0,C)}var B;try{B=h(D).find("script.hdb-template");if(B.exists()){B.each(function(J,K){let scriptId=h(K).attr("id");if(h(".handlebar-templates script#"+scriptId).exists()){h(K).remove()}else{h(".handlebar-templates").append(K)}})}}catch(F){console.debug(F)}if(!E){var I=false;var A=new RegExp("^(<div[^>]*ajax-refresh[^>]*>)(.*)","gi");var G=A.exec(D);if(G){I=h(G[1]+"</div>");D=D.replace(A,"$2");D=D.substring(0,D.lastIndexOf("</div>"))}}D+=H;return{html:D,$wrap:I}};var n=function(B,A){var C=B.attr("data-jalios-ajax-refresh-timeout");if(C){A.timeout=parseInt(C)}};const x=function(C,B){var A=C.attr("data-jalios-ajax-refresh-focus-element");if(A){B.focusElement=A}};const j=function(B,A){var C=B.attr("data-jalios-ajax-refresh-autofocus");if(C){A.autofocus=C}};const u=function(C,B){var A=C.attr("data-jalios-ajax-refresh-focus-target");if(A){B.focusTarget=A}};var g=function(A,B){var C=A.attr("data-jalios-ajax-refresh-waiting");if(!C){C=(A.attr("class")||"").match(/ajax-waiting-([\d\.]+)/);if(C){C=C[1]}else{return}}B.waiting=parseFloat(C)};var d=function(A,B){var C=A.attr("data-jalios-ajax-refresh-periodical");if(!C){C=(A.attr("class")||"").match(/ajax-periodical-(\d+)/);if(C){C=C[1]}else{return}}B.nohistory=true;B.nofocus=true;B.noscroll=true;B.periodical=parseInt(C)};var k=function(C,B){var A=C.attr("data-jalios-ajax-refresh-inner");if(A){B.inner=A;B.nohistory=true}};var y=function(C,B){if(B&&B.target){return h(B.target)}var F=C.attr("data-jalios-target");if(F){var A=C.attr("data-jalios-target-position");if(A){return C[this.position].apply(C,[F])}return h(F)}var E=C.closest("DIV.ajax-refresh-div");if(!E.exists()){var D=h.Event("jalios:refresh");D.refresh={};D.refresh.type="helper:target";D.refresh.$e=C;D.refresh.$target=false;h(document).trigger(D);E=D.refresh.$target}return E};var l=function(D,B,C){var E={};if(D.is("UL,OL")){E.nohistory=true;E.noscroll=true}d(B,E);d(D,E);n(B,E);n(D,E);k(B,E);k(D,E);g(B,E);g(D,E);u(D,E);x(D,E);j(D,E);E.trigger="#"+D.identify("jqid").attr("id");var F=D.prop("form");if(C.isform||E.isform){F=D.closest("FORM")}if(F){E.method=h(F).attr("method");E.noscroll=true;E.isform="#"+h(F).identify("jqid").attr("id")}E=h.extend(true,{},w,E,C);if(E.method&&"POST"==E.method.toUpperCase()){E.nohistory=true}var A=D.attr("data-jalios-ajax-refresh");if(A&&A.match(/nohistory/)){E.nohistory=true}if(A&&A.match(/nofocus/)){E.nofocus=true}else{if(A&&A.match(/focus/)){E.nofocus=false}}if(A&&A.match(/noscroll/)){E.noscroll=true}else{if(A&&A.match(/scroll/)){E.noscroll=false}}if(A&&A.match(/noerror/)){E.noerror=true}if(A&&A.match(/isform/)){E.isform=true}if(A&&A.match(/noresponse/)){E.noresponse=true}return E};var r=function(A,D,I){var B="";if(I.url){return I.url}if(A.attr("href")){B=A.prop("href");h.extend(true,I.params,h.jalios.Http.toQueryParams(B));B=B.split("?").shift()}var C=A.prop("form");if(I.isform){C=A.closest("FORM")}if(C){var J=h(C);B=J.attr("action");h.jalios.AjaxRefresh.triggerRefreshEvent(h.jalios.AjaxRefresh.RefreshEventType.SERIALIZE,B,D,I);h.extend(true,I.params,J.serializeObject());if(I.trigger){var F=h(I.trigger);if(F.is('BUTTON, INPUT[type="submit"], INPUT[type="image"]')){I.params[F.prop("name")]=F.prop("value")}}}if(D.isPortlet()){B="jcore/portal/ajaxPortal.jsp";I.params.portletId=D.getJcmsId();I.params.portletDomId=D.identify().attr("id");var E=D.getUsage();if(E){I.params.usage=E}}var G=D.children("A.ajax-refresh-url").first();if(G.exists()){B=G.prop("href")}var H=D.attr("data-jalios-ajax-refresh-url");if(H){B=H}var H=A.attr("data-jalios-ajax-refresh-url");if(H){B=H}return B};var f=function(F,D){var D=h.extend(true,{},D);var C=h(F);if(!C.exists()){return false}if(C.hasClass("disabled")){return false}var A=y(C,D);if(!A||!A.exists()){return false}D=l(C,A,D);var B=r(C,A,D);if(h.jalios.AjaxRefreshPropagation){if(h.jalios.AjaxRefreshPropagation.noCssPack===true){h.extend(true,D.params,{"no-css-pack":""})}if(h.jalios.AjaxRefreshPropagation.noJsPack===true){h.extend(true,D.params,{"no-js-pack":""})}}if(!D.confirm&&(C.hasClass("confirm")||C.hasClass("confirm-danger"))&&D._broked){var E=function(G){if(!G){return}D.confirm=true;if(C.attr("data-jalios-confirm")==="true"&&h.jalios.ui.Modal.latest&&h.jalios.ui.Modal.latest.trigger){h.jalios.DOM.follow(h.jalios.ui.Modal.latest.trigger,"modal","value",G)}else{if(C.data("jalios-confirm-callback")&&typeof C.data("jalios-confirm-callback")==="function"){let E=C.data("jalios-confirm-callback");E(G)}else{h.jalios.AjaxRefresh.refresh(B,A,D)}}};if(C.closest("DIV.modal").exists()){h.jalios.ui.Modal.confirmInModal(C,E)}else{if(C.hasClass("confirm-danger")){h.jalios.ui.Modal.confirmDanger(C,E)}else{h.jalios.ui.Modal.open(C,{confirm:true,callback:E})}}return true}return h.jalios.AjaxRefresh.refresh(B,A,D)};var i=function(B){var A=h.jalios.Event.match(B,"broker",v,true);if(!A){return}var C=A.source.currentTarget;A.options._broked=true;if(!A.options.target){A.options.target=A.target}h(C).refresh(A.options)};var q=function(B){var A=h(B.currentTarget);if(!f(A,{_broked:true})){return}B.preventDefault();B.stopPropagation();B.stopImmediatePropagation()};var c=function(){var B=h(document);var A=h(document.body);B.on("jalios:broker",i);B.on("click","A.ajax-refresh, button.ajax-refresh",q);B.on("click",":button.ajax-refresh, :submit.ajax-refresh, :image.ajax-refresh",q);h(document).on("keydown",function(C){if(!h(document.activeElement).is("button.ajax-refresh")&&!h(document.activeElement).is("a.ajax-refresh")){return}if(C.keyCode===m){h(document.activeElement).trigger("click");C.preventDefault()}});h("DIV.ajax-refresh-div.ajax-lazy").refresh({nohistory:true,noscroll:true});B.idleTimer(20000,{name:"LiveRefresh"});B.on("LiveRefresh.active",function(){h("DIV.ajax-refresh-div.ajax-live").refresh({nohistory:true,noscroll:true,noerror:true})});s(B)};var s=function(A){A.find("A.ajax-include").each(function(){var B=h(this).removeClass("ajax-include");if(B.closest(".popover").exists()){return}var C=h('<div class="ajax-include-div"></div>');B.refresh({target:C,noscroll:true,nohistory:true,callback:function(){B.replaceWith(C)}})})};const p=function(F,C,E,D,A,B){if(F||(C===0||!E)){h.console.warn(E)}else{toastr.options={positionClass:"toast-top-right"};toastr.options.onclick=function(){window.location.href=document.URL};toastr.error(h("body").is(".is-dev-mode")?D.slice(0,500):E)}e(A,false);b(A);if(A.is("#jalios-modal")){h.jalios.ui.Modal.close(true)}document.body.style.cursor="auto";throw new z(D,B)};h.jalios.AjaxRefresh={RefreshEventType:{SERIALIZE:"serialize",BEFORE:"before",AFTER:"after",SUCCESS:"success",FAIL:"fail"},triggerRefreshEvent:function(E,C,A,B,D){var F=h.Event("jalios:refresh");F.refresh={};if(!E){throw"Type is required"}F.refresh.type=E;F.refresh.url=C;F.refresh.target=A;F.refresh.options=B?B:{};F.refresh.html=D;h(document).trigger(F);return F},refreshPortlet:function(B,E,D,C){if(!D){D={}}if(!C){C={}}var A={nohistory:true,callback:E,params:D,replaceTarget:true};C=h.extend(true,{},A,C);return !h("DIV.ajax-refresh-div.ID_"+B).refresh(C)},refreshTarget:function(B){var A=y(h(B));if(A){A.refresh()}},refresh:function(D,F,C){if(!D){return false}var B=h(F);if(!B.exists()){return false}C=h.extend(true,{},w,C);var G=D.indexOf("?");if(G>0){var A=D.substring(G+1);D=D.substring(0,G);h.extend(true,C.params,h.jalios.Http.toQueryParams(A))}let event=h.jalios.AjaxRefresh.triggerRefreshEvent(h.jalios.AjaxRefresh.RefreshEventType.BEFORE,D,B,C);h.jalios.AjaxRefresh.LastRefresh=event;if(event.isPropagationStopped()){return true}if(!C.noresponse){if(!e(B,true,C)){return true}}b(B,true);let backupUrl=D;if(event.refresh.url.indexOf("http")!=0){D=h.jalios.Http.getBaseUrl()+event.refresh.url}var E=h.ajax({url:D,type:C.method===undefined?"POST":C.method,data:C.params,traditional:true,cache:C.cache,timeout:C.timeout});E.done(function(M){let event=h.jalios.AjaxRefresh.triggerRefreshEvent(h.jalios.AjaxRefresh.RefreshEventType.SUCCESS,backupUrl,B,C,M);if(C.noresponse){b(B);if(C.callback){C.callback(B,false)}return true}var K=function(N){if(!N){return false}var O=N.indexOf("<html");return O!=-1&&O<200};if(K(event.refresh.html)){h.jalios.AjaxRefresh.triggerRefreshEvent(h.jalios.AjaxRefresh.RefreshEventType.FAIL,backupUrl,B,C);p(C.noerror,undefined,I18N.glp("warn.json.sessiontimeout"),"Full html page, an ajax refresh page shouldn't have any HTML or Body tag",B,event.refresh.html)}var J=a(event.refresh.html,C.replaceTarget);var I=J.html;event.refresh.html=I;if(h.jalios.Common.blank(I)){b(B);if(C.callback){C.callback(B,false)}e(B,false,C);return false}var L=function(){if(C.replaceTarget){B.after(I).remove()}else{if(C.inner){h(C.inner).after(I).remove()}else{if(C.append){B.append(I)}else{B.html(I)}}}B.find("script.hdb-template").remove();if(J.$wrap){var O=J.$wrap[0];for(var N=0;N<O.attributes.length;N++){var Q=O.attributes[N];if(!Q.specified){continue}if(Q.name=="class"){continue}B.attr(Q.name,Q.value)}B.updateClass(O.className);d(B,C)}t(D,B,C);b(B);e(B,false,C);s(B);h.jalios.AjaxRefresh.triggerRefreshEvent(h.jalios.AjaxRefresh.RefreshEventType.AFTER,backupUrl,B,C);if(C.callback){C.callback(B,I)}if(C.periodical&&C.periodical>0){var R=C.periodical;C.periodical=undefined;var P=function(){var S=h(C.trigger);C.noerror=true;f(S.exists()?S:B,C)};R<30?P.delay(R):P.postpone(R)}};C.waiting&&h("HTML").hasClass("mdn-cssanimations")?L.delay(C.waiting):L();if(C.focusTarget){let focusInformation=h.jalios.a11y.getFocusInformation(C.focusTarget);h(focusInformation.firstFocusableElement).focus()}else{if(h(C.focusElement).exists()){const H=h(C.focusElement);if(!H.attr("tabindex")&&!H.is("a, button, [role=button]")){H.attr("tabindex","-1")}h(C.focusElement).focus()}else{if(C.autoFocus){let focusInformation=h.jalios.a11y.getFocusInformation(B);h(focusInformation.firstFocusableElement).focus()}}}});E.fail(function(I,J){let isTimeout=J==="timeout";var H=I&&!isTimeout&&!I.getAllResponseHeaders();if(H){return}event.refresh.type="fail";h(document).trigger(event);p(C.noerror,I.status,I18N.glp("warn.json.sessiontimeout"),I.status+" - "+I.responseText,B,I.responseText)});return true}};h.fn.refresh=function(A){return this.each(function(){f(h(this),A)})};h(document).ready(function(A){c()})})(window.jQuery);jQuery(document).on("jalios:refresh",function(b){if(!b||!b.refresh){return false}if(!Event.observe){return false}var c=b.refresh;try{if(c.type=="before"){var d=b.refresh.target.first().identify().attr("id");$(document).fire("refresh:before",{wrapper:d})}else{if(c.type=="after"){var d=b.refresh.target.first().identify().attr("id");$(document).fire("refresh:after",{wrapper:d})}}}catch(a){jQuery.console.error("AjaxRefresh","Exception while firing refresh:after",a)}});JCMS=JCMS||{};JCMS.ajax=JCMS.ajax||{};JCMS.ajax.Refresh=JCMS.ajax.Refresh||{};JCMS.ajax.Refresh.getFragment=function(b){jQuery.console.warn("[Deprecated] getFragment() Should use new Ajax-Refresh");jQuery.console.stacktrace();var a=$(document.body);if(b&&b.refresh){return $(b.refresh.target[0])}return a};JCMS.ajax.Refresh.refreshDIV=function(b,a){jQuery.console.warn("[Deprecated] refreshDIV() Should use new Ajax-Refresh");jQuery.console.stacktrace();jQuery(b).refresh({url:a})};JCMS.ajax.Refresh._request=function(c,b,a){jQuery.console.warn("[Deprecated] _request Should use new Ajax-Refresh",c);jQuery.console.stacktrace();a.url=b;a.target=c;jQuery(c).refresh(a)};JCMS.ajax.Refresh.refreshFromInput=function(a,b,c){jQuery.console.warn("[Deprecated] refreshFromInput() Should use new Ajax-Refresh");jQuery.console.stacktrace();jQuery(a).refresh({target:b,callback:c})};