!function(h){var p=function(){h.fn.popover.Constructor.DEFAULTS.sanitize=false;h(document).on("click","IMG.note",d);h(document).idleTimer(500,{name:"Hover"});h(document).on("Hover.idle",function(s){var r=h(s.timer.target);if(r.closest("DIV.popover.tt").exists()){return}if(r.closest(".dropdown-menu").exists()){return}i(r);b(r)});h(document).on("click",".ctxTooltipMenu",function(s){var r=h(s.currentTarget);b(r,true)});h(document).on("click",".ctxTooltipCard",function(s){var r=h(s.currentTarget);i(r,true)});h(document).on("mouseup",g);h(document).on("jalios:refresh",k);h(document).on("jalios:refresh",e)};var e=function(s){var r=h.jalios.Event.match(s,"refresh","after");if(!r){return}h(".tt-member2 .profile-contact-channel").tooltip()};var g=function(s){var r=h(s.target);if(!r.is("BUTTON.close")&&r.closest("DIV.popover.tt").exists()){return}if(r.data("bs.popover")){return}h("DIV.popover.tt").not(".tt-static").removeClass("in").hide()};var k=function(s){var r=h.jalios.Event.match(s,"refresh","before");if(!r){return}h("DIV.popover.tt").not(r.$target).removeClass("in").hide()};var c='<div class="popover popover-note tt-card tt no-focus"><div class="arrow"></div><button class="close icomoon-cross2 jalios-icon" type="button"></div></button><div class="popover-content ajax-refresh-div"></div></div>';var d=function(t){var r=h(t.target);var s=r.next("DIV.note").html();r.popover({html:true,template:c,container:"body",placement:"auto",content:s}).popover("show")};var m='<div class="popover tt-card tt no-focus"><div class="arrow"></div><button class="close icomoon-cross2 jalios-icon" type="button"></button><div class="popover-content ajax-refresh-div"></div></div>';var i=function(s,z){if(!s){return}if(h("BODY").hasClass("jcms-ttcard-disabled")){return}if(!s.is(".ctxTooltipCard")){var s=s.closest("A.ctxTooltipCard");if(!s.exists()){return}}if(s.prop("tagName")=="A"&&z){return}if(l(s,z)){return}if(s.closest(".noTooltipCard").exists()){return}var y=s.data("bs.popover");var x=s.data("popover-html");var w=y?y.tip():null;h("DIV.popover.tt").not(w).removeClass("in").hide();var u=(new Date()).getTime();if(x&&j+2000>u){s.popover({trigger:"manual",html:true,container:"body",delay:{show:500,hide:10000},template:m,content:x}).popover("show");return}j=u;var t=s.getJcmsId();var v=s.attr("class").replace("ID_"+t,"").replace("ctxTooltipCard","").replace(/^\s+|\s+$/g,"").replace(/\s+/g,"|");var r="jcore/tooltip/ttCard.jsp?ttId="+encodeURIComponent(t)+"&ttContext="+encodeURIComponent(v);h.ajax({url:r,dataType:"html",cache:true,success:function(A){var B=h("<DIV/>").html(A);let popoverCss=B.find("[data-jalios-ttcard-class]").data("jalios-ttcard-class");B.imagesLoaded(function(){s.popover({trigger:"manual",html:true,container:"body",delay:{show:500,hide:10000},template:m,placement:"auto",content:A});s.popover("show");y=s.data("bs.popover");y.refreshInProgress=true;y.$tip.addClass(popoverCss);s.data("popover-html",x);if(!A){y.refreshInProgress=false;w.hide();return}y.refreshInProgress=false;h.jalios.AjaxRefresh.triggerRefreshEvent(h.jalios.AjaxRefresh.RefreshEventType.AFTER,r,y.$tip)})}})};var j=0;var o=function(){var r=h(this);return r.data("popover-html")||m};var f='<div class="popover tt tip no-focus"><div class="arrow"></div><div class="popover-content ajax-refresh-div"></div></div>';var b=function(r,s){if(!r){return}if(!r.is(".ctxTooltipMenu")){return}if(r.prop("tagName")=="A"&&s){return}if(l(r,s)){return}var t=r.offset();if(t.top==0&&t.left==0){return}r.popover({trigger:"manual",html:true,container:"body",delay:{show:1000,hide:5000},template:f,placement:"auto left",content:q});a.call(r[0]);r.popover("show")};var q=function(){var r=h(this);return r.data("popover-html")||f};var a=function(){var w=h(this);var u=w.data("popover-html");var v=w.data("bs.popover");var y=w.data("bs.popover").tip();if(v.refreshInProgress==true){return u}h("DIV.popover.tt").not(y).removeClass("in").hide();var s=(new Date()).getTime();if(u&&j+2000>s){return n(w,y,u)}j=s;var r=w.attr("data-jalios-longdesc")||w.attr("data-jalios-tt-url");if(!r){r=w.attr("longDesc")}if(r){r+=(r.indexOf("?")>0?"&":"?")+"d="+(new Date()).getTime();w.refresh({url:r,target:y.find(".popover-content"),nohistory:true,noscroll:true,callback:function(z,A){if(!A){v.refreshInProgress=false;y.hide();return}v.refreshInProgress=true;n(w,y,A,true);v.show();v.refreshInProgress=false}})}else{if(w.attr("title")){var x='<p class="tip-content">'+w.attr("title")+"</p>";w.removeAttr("title");n(w,y,x);return x}else{if(w.attr("data-original-title")){var x='<p class="tip-content">'+w.attr("data-original-title")+"</p>";w.removeAttr("data-original-title");n(w,y,x);return x}else{if(u){n(w,y,u);return u}else{var t=w.nextAll(".ctxTooltip");if(!t.exists()){t=w.parent().nextAll(".ctxTooltip")}n(w,y,t.first().html());v.show()}}}}return"..."};var n=function(t,u,r,s){if(!r){u.hide();return}if(!s){u.find(".popover-content").html(r)}t.data("popover-html",r);return r};var l=function(s,t){if(!s.data("bs.popover")){return false}var u=s.data("bs.popover").$tip;if(u.hasClass("in")){if(t){u.removeClass("in").hide()}return true}var r=(new Date()).getTime();if(j+10000<r){return false}h("DIV.popover.tt").removeClass("in").hide();s.popover("show");return true};h(document).ready(function(r){p()})}(window.jQuery);