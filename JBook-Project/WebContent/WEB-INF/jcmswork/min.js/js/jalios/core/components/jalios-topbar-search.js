(function(h,j,k,d){var b=false;var a="";var f=h(".topbar-search-results-dummy");var c=function(){h(".topbar-search-overlay").addClass("full in");h("BODY").addClass("has-overlay");h("BODY").addClass("has-search-overlay")};var e=function(){h(".topbar-search-overlay").removeClass("full in");h("BODY").removeClass("has-overlay");h("BODY").removeClass("has-search-overlay")};var g=function(){h(".topbar-search-inner").each(function(m,n){var l=h(n);if(!l.find(".ajax-loading-component-waves").exists()){l.html("").displayLoadingWaves()}})};var i=function(){e();f.removeClass("is-searching");f.addClass("hide");h(k).off("keydown.jalios.topbar.search")};h(k).ready(function(){f.prependTo(h("BODY"));h(k).on("click",".topbar-search-close",function(l){i()});h(k).on("keydown",function(l){if(h(k.activeElement).is(".topbar-search-close")&&(l.keyCode===13||l.keyCode===32)){i();l.preventDefault()}});h(k).on("keyup",function(l){switch(l.keyCode){case 27:i();break}});h(k).on("click",".btn-full-search",function(m){var l=h(".topbar-search-wrapper FORM");l.submit()});h(k).on("click",".topbar-search-overlay",function(l){i()});h(k).on("input change propertychange",".topbar-search-query",function(o){var q=h(o.currentTarget);var m=h(o.currentTarget).closest(".topbar-search-wrapper");var n=h(o.currentTarget).data("jalios-ajax-refresh-url");var p=o.target.value;var l=q.attr("data-ac-min-length")||h.jalios.Properties.get("autocomplete-min-chars");if(p.length<l){a=""}if(p===a){return}if(p.length<l){c();f.addClass("is-searching");f.removeClass("hide");setTimeout(function(){g();var r=f.find(".topbar-search-inner .ajax-loading-component-waves");var s=f.find(".topbar-search-inner").data("jalios-loading-label");if(!r.find(".loading-label").exists()){r.append(h("<SPAN/>").addClass("loading-label").text(s))}},400);return}else{c();f.addClass("is-searching");f.removeClass("hide");setTimeout(function(){g()},400)}if(b){clearTimeout(b)}b=setTimeout(function(){h(k).off("keydown.jalios.topbar.search");a=p;h.jalios.AjaxRefresh.refresh(n,h(".topbar-search-results-dummy .search-global"),{params:{autocomplete:p},noscroll:true,nohistory:true,callback:function(){let focusInformation=h.jalios.a11y.getFocusInformation(h(".topbar-search-inner"));h(k).on("keydown.jalios.topbar.search",function(r){if(r.keyCode===9&&!(r.shiftKey|r.ctrlKey|r.metaKey|r.altKey)){if(h(r.target).hasClass("topbar-search-close")){r.preventDefault();h("#a11y-global-search").focus()}else{if(h(r.target).hasClass("topbar-search-query")){r.preventDefault();h(focusInformation.firstFocusableElement).focus()}}}if(r.keyCode===13&&h(r.target).hasClass("topbar-search-close")){i();r.preventDefault();h("#a11y-global-search").focus()}});h(".topbar-search-results-wrapper").each(function(r,s){new PerfectScrollbar(s,{suppressScrollX:true})})}});b=false},h.jalios.Properties.get("autocomplete-chooser-timeout"))})})})(jQuery,window,document);