!function(a){tinymce.PluginManager.add("pastelink",function(i,b){var j=i.getParam("pastelink_jlink",true);var g=i.getParam("pastelink_jlink_title",true);var d=function(m){return m&&m.indexOf(JcmsJsContext.getBaseUrl())==0&&m.indexOf("?")==-1};var h=function(o,n){if(j&&d(n)){var m=i.jcms.getMediaInfos(n);if(m&&m.source&&m.url){o.setAttribute("data-jalios-link-id",m.source);o.setAttribute("data-jalios-url",m.url);o.href=m.displayUrl||m.url;if(g&&m.title){o.textContent=m.title}}}};var e=function(w){var u=/((?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(?:[^\s,;!]+))(?=(?:[\s\),;:\.!?])|$)/g;var p=w.split(u);if(!p||p.length<=1){return null}var n=[];var r="";for(var s=0,q=p.length;s<q;s++){var x=p[s];var o;if(x.match(u)){var m=x;var t=m.match(/^(.+)([\s\),;:\.!?])$/);if(t){m=t[1];r=t[2]}var v=m;if(m.indexOf("www")===0){m="http://"+m}o=document.createElement("a");o.href=m;o.textContent=v;h(o,m)}else{o=document.createTextNode(r+x);r=""}n.push(o)}return n};function l(o,n,m){while(o&&o!==n){if(m(o)){return o}o=o.parentNode}return null}function k(o,n,m){return l(o,n,m)!==null}function c(o,m,n){return k(o,m,function(p){return p.nodeName===n})}var f=function(s){var n=s.node;var r=s.node;var t=new tinymce.dom.TreeWalker(r,n);do{if(r.nodeType==1&&r.nodeName==="A"&&r.href===r.textContent){h(r,r.href);continue}if(r.nodeType==3){if(c(r,n,"A")){continue}var o=e(r.textContent);if(o&&o.length>0){for(var q=0,m=o.length;q<m;q++){var p=o[q];r.parentNode.insertBefore(p,r)}r.remove();t=new tinymce.dom.TreeWalker(o[o.length-1],n)}}}while((r=t.next()))};i.on("PastePostProcess",f)})}(window.jQuery);