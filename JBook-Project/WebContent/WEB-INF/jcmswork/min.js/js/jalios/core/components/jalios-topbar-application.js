(function(c,e,k,d){if(!c.jalios){c.jalios={}}if(!c.jalios.topbar){c.jalios.topbar={}}if(!c.jalios.topbar.applicationmenu){c.jalios.topbar.applicationmenu={}}c.jalios.topbar.applicationmenu={refreshApplicationMenuBadges:function(){c("[data-jalios-application-async-url]").each(function(u,v){var t=c(v);l(t)})}};var o=false;var m=null;var i=function(){c(k).on("click",".js-show-more-application-items",function(v){var u=c(".topbar-application-menu .topbar-application-item-inner-global");var t=c(".topbar-application-menu .topbar-ctxmenu-body");c(this).toggleClass("is-expanded");if(u.hasClass("is-expanded")){u.toggleClass("is-expanded")}else{u.toggleClass("is-expanded");var w=c(".topbar-application-menu .topbar-application-item-mbr");t.animate({scrollTop:w.height()})}f();a()})};var s=function(){c(k).on("hide.bs.dropdown",function(v){if(c(v.relatedTarget).hasClass("topbar-application-menu")){var u=c(".topbar-application-menu .topbar-application-item-global");if(u.hasClass("is-expanded")){var t=c(".topbar-application-menu .topbar-ctxmenu-body");t.scrollTop(0);u.toggleClass("is-expanded");a()}}})};var a=function(){if(m!=null){m.update()}};var g=function(){c(".topbar-application-item-mbr-clone").width(c(".topbar-application-item-mbr").width()).height(c(".topbar-application-item-mbr").height());c(".topbar-application-item-global-clone").width(c(".topbar-application-item-global").width()).height(c(".topbar-application-item-global").height())};var h;var j=function(){g();c(".topbar-application-item-mbr, .topbar-application-item-global").sortable({start:function(v,u){c(".topbar-application-item-mbr-clone").removeClass("hide");c(".topbar-application-item-global-clone").removeClass("hide");h=u.helper.clone();h.addClass("app-draggable-clone");h.css("position","absolute");c(".topbar-application-menu .topbar-ctxmenu-body").prepend(h);u.helper.css("visibility","hidden");f();var t=false;if(u.helper.parent().hasClass("topbar-application-item-mbr")){t=true}c(k).on("mousemove.helperAppEvent",function(w){if(t){h.css({top:u.helper.position().top,left:u.helper.position().left})}else{var x=c(".topbar-application-item-mbr").outerHeight()+u.helper.position().top;h.css({top:x,left:u.helper.position().left})}});u.helper.addClass("exclude-me");c(".topbar-application-item-mbr a:not('.exclude-me')").css("visibility","hidden");c(".topbar-application-item-global a:not('.exclude-me')").css("visibility","hidden");u.helper.data("clone").hide()},change:function(u,t){g();c(".topbar-application-item-mbr a:not(.exclude-me, .ui-sortable-placeholder)").each(function(){var w=c(this);var x=w.data("clone");x.stop(true,false);var v=w.position();x.animate({left:v.left,top:v.top},150)});c(".topbar-application-item-global a:not(.exclude-me, .ui-sortable-placeholder)").each(function(){var w=c(this);var x=w.data("clone");x.stop(true,false);var v=w.position();x.animate({left:v.left,top:v.top},200)})},delay:150,containment:c(".topbar-application-menu .topbar-ctxmenu-body"),connectWith:".topbar-application-item-wrapper",tolerance:"pointer",stop:function(v,y){c(k).off("mousemove.helperAppEvent");h.remove();var z=c(v.target);var t=z.data("jalios-dataid");var x=[];c(".topbar-application-item-mbr .topbar-application-item").each(function(B,C){var D=c(C).data("jalios-dataid");var A=c(C);if(D!=null&&D!==t){x[B]=A.data("jalios-dataid")}else{if(A.hasClass("ui-sortable-placeholder")){x[B]=t}}});var w=[];c(".topbar-application-item-global .topbar-application-item").each(function(B,C){var D=c(C).data("jalios-dataid");var A=c(C);if(D!=null&&D!==t){w[B]=A.data("jalios-dataid")}else{if(A.hasClass("ui-sortable-placeholder")){w[B]=t}}});var u=JSON.stringify({mbrIds:x,globalIds:w});c.ajax({url:"front/memberpreference/savePreference.jsp",method:"post",data:{key:"core.application.member-application",value:u}});c(".topbar-application-item-mbr a.exclude-me").each(function(){var B=c(this);var C=B.data("clone");var A=B.position();C.css("left",A.left);C.css("top",A.top);C.show();B.removeClass("exclude-me")});c(".topbar-application-item-global a.exclude-me").each(function(){var B=c(this);var C=B.data("clone");var A=B.position();C.css("left",A.left);C.css("top",A.top);C.show();B.removeClass("exclude-me")});c(".topbar-application-item-mbr a").css("visibility","visible");c(".topbar-application-item-global a").css("visibility","visible");c(".topbar-application-item-mbr-clone").addClass("hide");c(".topbar-application-item-global-clone").addClass("hide");f()}})};var r=c("<span>",{"class":"topbar-item-badge fade"}),q="app-badge-level-";var p=function(){c("[data-jalios-application-async-url]").each(function(u,v){var t=c(v);l(t)})};var l=function(v){var u=c(v);var t=u.data("jalios-dataid");c.getJSON(u.data("jalios-application-async-url"),{shortcutId:t},function(x){if(x){if(u.find(".topbar-item-badge").exists()){u.find(".topbar-item-badge").remove()}if(x.title){u.find(".label-wrapper").html(x.title)}if(x.url){u.attr("href",x.url)}var y=x.badgeLevel&&x.badgeText;if(y){var w=r.clone();w.html(x.badgeText);w.addClass(q+x.badgeLevel.toLowerCase());if(x.badgeTitle){w.attr("title",x.badgeTitle)}u.prepend(w);w.addClass("in")}}})};var f=function(){c(".topbar-application-item-mbr-clone").empty();c(".topbar-application-item-mbr a.topbar-application-item").each(function(){var u=c(this);var v=u.clone();u.data("clone",v);var t=u.position();v.css("left",t.left);v.css("top",t.top);v.addClass("is-clone");c(".topbar-application-item-mbr-clone").append(v)});c(".topbar-application-item-global-clone").empty();c(".topbar-application-item-global a.topbar-application-item").each(function(){var u=c(this);var v=u.clone();u.data("clone",v);var t=u.position();v.css("left",t.left);v.css("top",t.top);v.addClass("is-clone");c(".topbar-application-item-global-clone").append(v)})};var n=function(){m=new PerfectScrollbar(".topbar-application-menu .topbar-ctxmenu-body")};var b=function(){j();s();i();n();p()};c(k).ready(function(){b()})})(jQuery,window,document);