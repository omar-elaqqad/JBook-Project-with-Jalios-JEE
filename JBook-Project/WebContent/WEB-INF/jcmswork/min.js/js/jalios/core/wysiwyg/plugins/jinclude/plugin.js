!function(a){tinymce.PluginManager.add("jinclude",function(e,g){var r="jalios:include";var d="data-jalios-type";var p="data-jalios-params";var l="iframe";var o="data-jalios-include-type";var i="data-mce-p-"+o;var b="js/jalios/core/wysiwyg/plugins/jinclude/jsp/jincludePreview.jsp";var q=e.getParam("include_template","<"+r+"@attributes@ />");var h=e.getParam("include_placeholder","<"+l+'@attributes@ contenteditable="false"></'+l+">");var n="<"+r+"[^>]*"+d+'="([^"]+)"[^>]*>(</'+r+">)?";var k="<"+l+"[^>]*"+o+'="([^"]+)"[^>]*>[^<]*</'+l+">";e.addCommand("JaliosInsert-include",function(x,t){if(!t){return}var w=t["data-jalios-type"];var u=t["data-jalios-params"];if(w&&u){var v=f(w,u);e.insertContent(v)}});e.on("ResolveName",function(u){var t=u.target;if(s(t)){u.name="jalios:include"}});e.on("BeforeSetContent",function(t){t.content=c(t.content)});e.on("PostProcess",function(t){if(t.get){t.content=j(t.content)}});function s(t){return(t.nodeName.toUpperCase()===l.toUpperCase()&&e.dom.getAttrib(t,o))||(t.nodeName.toUpperCase()==="SPAN"&&e.dom.hasClass(t,"mce-object-iframe")&&e.dom.getAttrib(t,i))}function c(u){var t=new RegExp(n,"gi");return u.replace(t,function(w,v){var y=a(w);var z=y.attr(d);var x=y.attr(p);if(z&&x){return f(z,x)}else{return w}})}function j(u){var t=new RegExp(k,"gi");u=u.replace(t,function(w,v){var y=a(w);var z=y.attr(o);var x=y.attr(p);return m(z,x)});return u}function m(v,u){var t=" ";t+=v?' data-jalios-type="'+v+'"':"";t+=u?' data-jalios-params="'+u+'"':"";return q.replace(/@attributes@/g,t)}function f(w,v){var u=b+"?type="+encodeURIComponent(w)+(v?"&amp;params="+encodeURIComponent(v):"");u=JCMS.Security.getUrlWithCSRFToken(u);var t=' src="'+u+'" '+o+'="'+w+'" data-mce-src="'+u+'"';t+=w?' data-jalios-type="'+w+'"':"";t+=v?' data-jalios-params="'+v+'"':"";return h.replace(/@attributes@/g,t)}})}(window.jQuery);