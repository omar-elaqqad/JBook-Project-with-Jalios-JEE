(function(h,k,l,f){var d=new Date().getTime();var b=null;var e=0,g;var j=2;if(!h.jalios){h.jalios={}}if(!h.jalios.alert){h.jalios.alert={}}if(!h.jalios.alert.topbar){h.jalios.alert.topbar={}}h.jalios.alert.topbar={_intervalTime:null,refreshCounter:function(o){var q=h(".topbar-alert-menu .alert-count");if(!q.exists()){return}if(!o.alert||!o.alert.unreadInfo){return}var p=o.alert.unreadInfo;if(p.count===0){q.removeClass("in");let alertCountAriaLive=h.jalios.I18N.glp("ui.topbar.alert-menu.title",p.count);let alertCountMenuTitle=h.jalios.I18N.glp("ui.topbar.alert-menu-opener.empty-title");h(".js-topbar-alert-count-title").html(alertCountAriaLive);h("#topbar-alert-menu-opener").attr("title",alertCountMenuTitle)}else{if(p.count>0){q.removeClass("alert-badge-info");q.removeClass("alert-badge-action");q.removeClass("alert-badge-warning");q.removeClass("two-digits");q.removeClass("three-digits");q.removeClass("bounce");q.html(p.count);let alertCountAriaLive=h.jalios.I18N.glp("ui.topbar.alert-menu.title",p.count);let alertCountMenuTitle=h.jalios.I18N.glp("ui.topbar.alert-menu-opener.title",p.count);h(".js-topbar-alert-count-title").html(alertCountAriaLive);h("#topbar-alert-menu-opener").attr("title",alertCountMenuTitle);if(p.count>9&&p.count<100){q.addClass("two-digits")}else{if(p.count>99){q.addClass("three-digits");q.html("99+")}}if(p.level){q.addClass("alert-badge-"+p.level.toLowerCase())}if(!q.hasClass("in")){q.addClass("in")}if(o.alert.prevUnreadInfo){q.addClass("bounce")}}}},getSlideMenuPlugin:function(p){var o=h(".topbar-alert-menu-dropdown .slide-wrapper");if(o.exists()){var q=o.data("plugin_topbarSlideMenu");if(q){return q}else{h.console.warn("[alert-topbar]","getSlideMenuPlugin","Could not retrieve slideMenu")}}},recomputeMenuHeight:function(p){var o=h.jalios.alert.topbar.getSlideMenuPlugin();if(o){o.recomputeHeight()}},truncateItems:function(p){var q=h.jalios&&h.jalios.truncate;if(q){var o=".topbar-alert-menu-dropdown .alert-menu-item:not(.js-truncated) .alert-description";h(o).each(function(r,s){h(s).find("P:nth-child(n+2)").remove();h(s).addClass("js-truncated");h(s).jalios_truncate({value:j})});h.jalios.alert.topbar.recomputeMenuHeight()}},isAutoRead:function(o){if(!o){return}return h(".topbar-alert-menu.is-auto-read-"+o).exists()},setAutoRead:function(o){if(!o||!Array.isArray(o)){return}let $levelsElt=h(".topbar-alert-menu");if(!$levelsElt.exists()){return}$levelsElt.removeClass("is-auto-read-info");$levelsElt.removeClass("is-auto-read-action");$levelsElt.removeClass("is-auto-read-warning");for(let i=0;i<o.length;i++){let alertLevel=o[i];if(alertLevel){$levelsElt.addClass("is-auto-read-"+alertLevel)}}}};var c=function(o){if(o.alert){if(o.alert.type==="refresh"){h.jalios.alert.topbar.refreshCounter(o)}}};var m=function(){if(l.hidden){clearInterval(g);d=new Date().getTime()}else{var p=d-new Date().getTime();var o=Math.abs(p);if(o>h.jalios.alert.topbar_intervalTime){h.jalios.alert.refreshUnreadInfo()}g=setInterval(a,h.jalios.alert.topbar_intervalTime)}};var a=function(){if(!l.hidden){h.jalios.alert.refreshUnreadInfo()}};var n=function(){h(l).on("jalios:alert",c);l.addEventListener("visibilitychange",m,false);h(l).on("jalios:ready",h.jalios.alert.topbar.truncateItems)};h(l).ready(function(){b=h(".topbar-item-alert-menu");h.jalios.alert.topbar_intervalTime=b.data("jalios-alert-refresh-interval");n();g=setInterval(a,h.jalios.alert.topbar_intervalTime)})})(jQuery,window,document);