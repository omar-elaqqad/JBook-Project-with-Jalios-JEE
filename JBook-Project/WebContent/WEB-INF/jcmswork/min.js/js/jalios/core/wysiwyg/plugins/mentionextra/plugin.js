!function(a){tinymce.PluginManager.add("mentionextra",function(g,b){var m="jalios:mention";var d="a";var h="mention";var k=g.getParam("mention_template","<"+m+"@attributes@ />");var j=g.getParam("mention_placeholder","<"+d+'@attributes@ class="'+h+'" contenteditable="false"><span class="jalios-mention-fullname">@fullName@</span></'+d+">");var i="<"+m+"[^>]*>(</"+m+">)?";var l=("<"+d+'[^>]*class="'+h+'[^"]*"[^>]*><span[^>]*class="jalios-mention-fullname"[^>]*>[^<]*</span></'+d+">").replace(/></g,">[\\r\\n\\t\\s]*<");g.jalios.plugins.mention={createTag:function(o){var n="";n+=' data-jalios-id="'+window.encodeURIComponent(o.memberId)+'"';return k.replace(/@attributes@/g,n)},createHtmlTag:function(o){var n="";n+=' data-jalios-mention-id="'+window.encodeURIComponent(o.id)+'"';var p=o.fullName;return j.replace(/@attributes@/g,n).replace(/@fullName@/g,p)}};g.on("ResolveName",function(o){var n=o.target;if(c(n)){o.name="jalios:mention"}});function c(n){return n.nodeName.toUpperCase()===d.toUpperCase()&&g.dom.hasClass(n,h)}g.on("BeforeSetContent",function(n){n.content=f(n.content)});function f(o){var n=new RegExp(i,"gi");return o.replace(n,function(p){var r=a(p);var q=r.data("jalios-id");var s=g.jcms.getMemberInfos(q);return s&&s.id?g.jalios.plugins.mention.createHtmlTag(s):p})}g.on("PostProcess",function(n){if(n.get){n.content=e(n.content)}});function e(o){var n=new RegExp(l,"gi");return o.replace(n,function(p){var q=a(p);return g.jalios.plugins.mention.createTag({memberId:q.data("jalios-mention-id")})})}})}(window.jQuery);