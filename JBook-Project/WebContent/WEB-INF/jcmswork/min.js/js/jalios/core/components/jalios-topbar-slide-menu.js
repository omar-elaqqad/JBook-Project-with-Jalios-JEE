(function(e,g,h,c){var b=false;"use strict";var f="topbarSlideMenu",a=null,d={propertyName:"value"};function i(l,k){this.element=l;this.settings=e.extend({},d,k);this._defaults=d;this._name=f;this.init()}e.extend(i.prototype,{init:function(){var k=e(this.element);if(k.find(".js-slidemenu-input-refresh").exists()){k.find(".js-slidemenu-input-refresh").focus()}a=new PerfectScrollbar(k.closest(".topbar-ctxmenu-body")[0]);k.on("click keydown","[data-bound]:not(.main-menu):not(.child-menu)",function(l){if(!e.jalios.a11y.isFocusedClick(l)){return}var s=e(l.target).closest("A.js-no-slide");if(s.length){var m=s.data("bound");if(!m){return}}l.preventDefault();var n=e(l.currentTarget).data("bound");var q="DIV[data-bound='"+n+"']";var t=e(l.currentTarget).data("jalios-slidemenu-bound-mode");if(e(q).hasClass("hide")){e(q).removeClass("hide")}var p=e(l.currentTarget).closest(".list-group");var r=e(l.currentTarget).closest(".slide-wrapper");if(t==="back"){e(q).addClass("is-active").removeClass("is-parent");p.removeClass("is-active is-parent");e(q).one(e.support.transition.end,function(){if(r.exists()){r.find(".list-group:not(.is-active)").addClass("hide");var v=e(l.currentTarget).closest(".child-menu");var u=e.Event("jalios.topbar.slidemenu.backToMainMenu",{childMenu:v});r.trigger(u)}})}else{e(q).addClass("is-active");if(p.hasClass("child-menu")){p.addClass("is-parent")}else{p.removeClass("is-active")}if(r.exists()){e(q).one(e.support.transition.end,function(){r.find(".list-group:not(.is-active)").addClass("hide");var v=e(l.currentTarget).closest(".slide-wrapper").find(".child-menu.is-active");var u=e.Event("jalios.topbar.slidemenu.transition.end",{childMenu:v});r.trigger(u)})}}if(r.exists()){r.data("plugin_topbarSlideMenu").recomputeHeight()}var o=e(l.currentTarget).closest(".topbar-ctxmenu-body");if(o.exists()){o[0].scrollTop=0}});k.on("input change propertychange",".js-slidemenu-input-refresh",function(l){var t=e(l.currentTarget);var p=e(l.currentTarget).closest(".slide-wrapper");var o=p.data("jalios-ajax-refresh-url");var q=p.find(".js-slidemenu-input-refresh-wrapper");var r=l.target.value;var m=t.attr("data-ac-min-length")||e.jalios.Properties.get("autocomplete-min-chars");if(r.length<m&&r.length!==0){return}if(b){clearTimeout(b)}var s=t.attr("name");var n={};n[t.attr("name")]=r;b=setTimeout(function(){q.displayLoading();e.jalios.AjaxRefresh.refresh(o,q,{params:n,noscroll:true,nohistory:true,callback:function(){var u=e(l.currentTarget).closest(".slide-wrapper");if(u.exists()){u.data("plugin_topbarSlideMenu").recomputeHeight()}}});b=false},e.jalios.Properties.get("autocomplete-chooser-timeout"))});e(h).on("jalios:refresh",function(p){var n=e.jalios.Event.match(p,"refresh","after");if(!n||!n.target){return}var r=e(n.target).closest(".slide-wrapper");if(e(".browser-IE11").length&&r.exists()&&r.hasClass("workspace-menu")&&!r.data("is-height-set")){r.data("is-height-set",true);var q=r.find(".slide-menu-search-input");var s=q.exists()?q.outerHeight():0;var m=r.find(".list-group").outerHeight();var l=s+m;r.closest(".dropdown-menu").css("height",l)}var o=r.data("plugin_topbarSlideMenu");if(o){r.data("plugin_topbarSlideMenu").recomputeHeight()}})},returnToMainMenu:function(k){if(!k||(!k.exists()&&!k.hasClass(".child-menu"))){return}k.removeClass("is-active");var l=k.closest(".slide-wrapper");l.find(".main-menu").removeClass("hide").addClass("is-active");k.one(e.support.transition.end,function(){l.find(".list-group:not(.is-active)").addClass("hide");var m=e.Event("jalios.topbar.slidemenu.returnToMainMenu",{childMenu:k});l.trigger(m)});this.recomputeHeight()},recomputeHeight:function(){var n=e(this.element);var k=n.find(".list-group.is-active:not('.is-parent')").outerHeight();var m=n.find(".slide-menu-search-input");var o=n.find(".main-menu.is-active:not('.is-parent')").exists()&&m.exists()?n.find(".slide-menu-search-input").outerHeight():0;var l=k+o;n.animate({height:l},200);n.one(e.support.transition.end,function(){a.update()})}});e.fn[f]=function(k){return this.each(function(){if(!e.data(this,"plugin_"+f)){e.data(this,"plugin_"+f,new i(this,k))}})};e(h).ready(function(){e(".slide-wrapper").topbarSlideMenu();e(h).on("jalios:topbar-dropdown",j);e(h).on("shown.bs.dropdown",function(k){var l=e(k.target).find(".slide-wrapper").data("plugin_topbarSlideMenu");if(l){l.recomputeHeight()}});e(h).on("hide.bs.dropdown",function(l){var k=e(l.target).find(".js-slidemenu-input-refresh");if(k.exists()&&k.val()){k.val("");k.trigger("change")}})});var j=function(k){if(k.dropdown.type!=="done"){return}e(".slide-wrapper").topbarSlideMenu()}})(jQuery,window,document);