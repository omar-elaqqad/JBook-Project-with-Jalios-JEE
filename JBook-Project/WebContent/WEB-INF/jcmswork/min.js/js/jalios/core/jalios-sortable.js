!function(e){var d=function(){a();e(document).on("jalios:refresh",f)};var f=function(h){var g=e.jalios.Event.match(h,"refresh","after");if(!g){return}if(!g.target){return}a(g.target)};var a=function(h){h=h||e(document);h.find("UL.sortable, OL.sortable").each(function(){e.jalios.Sortable.buildSortable(this,{connectWith:e(this).attr("data-jalios-sortable-connect")})});var g="sortable-active";h.find("DIV.dnd-container").each(function(){var j=e(this);var i=j.hasClass("dnd-horizontal")?"x":j.hasClass("dnd-vertical")?"y":false;e.jalios.Sortable.buildSortable(this,{items:"> DIV",axis:i,revert:true,handle:".dnd-header, .dnd-handle",placeholder:"dnd-placeholder",connectWith:j.hasClass("dnd-single")||i?false:"DIV.dnd-container"})})};var c=function(i,g){var h=e(i);if(g&&h.hasClass("sortable-active")){return}if(!g&&!h.hasClass("sortable-active")){return}h.toggleClass("sortable-active",g)};var b=function(l,m){var g=e(l);if(g.hasClass("dnd-debug")){if(l===m.item.parent()[0]){if(m.sender!==null){jQuery.console.log("[jalios-sortable]"," item",m.item," moved from container",m.sender," to ",g)}else{jQuery.console.log("[jalios-sortable]"," item ",m.item," moved inside container",g)}}}var j=g.hasClass("dnd-single-update");if(j&&l!==m.item.parent()[0]){return}var k=jQuery.Event("jalios:sortable");k.sortable={container:g,ui:m};e(document).trigger(k);var i=e.jalios.Sortable.serialize(g,g.hasClass("dnd-container")?"dnd-sortable":false);if(j&&m.sender!==null){var h=e.jalios.Sortable.serialize(m.sender,e(m.sender).hasClass("dnd-container")?"dnd-sortable-sender":"sortable-sender");i=e.extend(i,h)}k.currentTarget=l;e.jalios.DataBroker.trigger(g,k,{params:i})};if(!e.jalios){e.jalios={}}e.jalios.Sortable={serialize:function(g,k){var k=k||"sortable";var m=e(g);var i=m.children().map(function(){var q=e(this);var p=q.attr("data-value")||q.getJcmsId();if(p){return p}var o=q.children(":first");p=o.attr("data-value")||o.getJcmsId();if(p){return p}return q.attr("id")}).get();var n=e.jalios.Sortable.getSortableKey(m);var l={};var j=m.attr("data-sortable-params");try{l=e.extend(l,j&&JSON.parse(j))}catch(h){jQuery.console.error("Error parsing data-sortable-params on ",m,h)}l[k||"sortable"]=n;l[n]=i;return l},getSortableKey:function(g){return g.attr("data-value")||g.attr("id")||g.getJcmsId()||"sortitem"},buildSortable:function(i,h){var g=e(i);var h=h||{};g.sortable({items:h.items||"> LI",cancel:h.cancel||".sortable-disable, :input",axis:h.axis||(g.hasClass("sortable-x")?"x":g.hasClass("sortable-y")?"y":false),revert:h.revert||true,handle:h.handle||(g.hasClass("sortable-handle")?".sortable-handle":false),connectWith:h.connectWith||false,tolerance:h.tolerance||"intersect",placeholder:h.placeholder,update:function(j,k){b(this,k)},stop:function(j,k){c(this,false)},sort:function(j,k){c(this,true)},out:function(j,k){c(this,false)},over:function(j,k){c(this,true)}})}};e.fn.sortable=e.fn.sortable||{};e.fn.sortable.add=function(i){var h=e(i);if(!h.exists()){var g=e(this).hasClass("sortable")?"li":"div";h=e("<"+g+' data-value="'+i+'"></'+g+">")}return this.each(function(){e(this).append(h);b(this)})};e.fn.sortable.remove=function(g){e(g).remove();return this.each(function(){b(this)})};e(document).ready(function(g){d()})}(window.jQuery);var Sortable={};Sortable.create=function(){jQuery.console.warn("[Deprecated] JCMS requires the new Sortable framework");jQuery.console.stacktrace()};Sortable.destroy=function(){jQuery.console.warn("[Deprecated] JCMS requires the new Sortable framework");jQuery.console.stacktrace()};var Droppables={};Droppables.add=function(){jQuery.console.warn("[Deprecated] JCMS requires the new Sortable framework");jQuery.console.stacktrace()};var PortalSortable={};PortalSortable.create=function(){jQuery.console.warn("[Deprecated] JCMS requires the new Sortable framework");jQuery.console.stacktrace()};