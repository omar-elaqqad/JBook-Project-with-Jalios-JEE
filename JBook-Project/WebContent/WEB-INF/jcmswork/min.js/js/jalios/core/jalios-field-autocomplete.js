(function(e,g,h,c){var a=false;"use strict";var f="fieldAutocomplete",d={propertyName:"value"};function i(l,k){this.element=l;this.settings=e.extend({},d,k);this._defaults=d;this._name=f;this.backupedSearch="";this.init()}e.extend(i.prototype,{init:function(){var l=this;var k=e(this.element);k.closest("form").on("keyup keypress",function(n){if(e(h.activeElement)[0]!==k[0]){return}var m=n.keyCode||n.which;if(m===13){n.preventDefault();return false}});k.on("input change propertychange",k,function(q){var p=k.data("jalios-field-autocomplete");var m=e(k.data("jalios-target"));if(!p||!m.exists()){return}var r=q.target.value;if(r===l.backupedSearch){return}l.backupedSearch=r;var n=k.attr("data-ac-min-length")||e.jalios.Properties.get("autocomplete-min-chars");if(r.length<n&&r.length!==0){return}if(a){clearTimeout(a)}if(k.data("jalios-field-autocomplete-form")){var s=new FormData(k.closest("form").get(0));var t={};s.forEach(function(v,u){if(v){t[u]=v}})}else{var o=k.attr("name");var t={};t[k.attr("name")]=r}a=setTimeout(function(){if(e.fn.displayLoading){m.displayLoading()}e.jalios.AjaxRefresh.refresh(p,m,{fieldAutocomplete:true,params:t,noscroll:true,nohistory:true,callback:function(){}});a=false},e.jalios.Properties.get("autocomplete-chooser-timeout"))})}});e.fn[f]=function(k){return this.each(function(){if(!e.data(this,"plugin_"+f)){e.data(this,"plugin_"+f,new i(this,k))}})};var j=function(){e("[data-jalios-field-autocomplete]").fieldAutocomplete()};var b=function(l){var k=e.jalios.Event.match(l,"refresh","after");if(!k||!k.target){return}e("[data-jalios-field-autocomplete]").fieldAutocomplete()};e(h).ready(function(){j();e(h).on("jalios:refresh",b)})})(jQuery,window,document);