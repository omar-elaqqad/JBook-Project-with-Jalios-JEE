!(function(e){var a=null;var h=function(){e(window).bind("storage",b);e("body").tooltip({selector:"[data-toggle=tooltip]"});e(document).on("click",".js-jportal-preview-mode-rotate",function(j){e("#jportalPreviewIframe").toggleClass("is-landscape");e(".js-jportal-preview-mode-rotate").toggleClass("is-active")});e(document).on("click",".js-jportal-preview-mode-smartphone",function(j){g();d();e(".js-jportal-preview-mode-smartphone").addClass("is-active");e(".jportal-preview-mode-rotate").removeClass("disabled");e("#jportalPreviewIframe").addClass("jportal-preview-mode-smartphone");f()});e(document).on("click",".js-jportal-preview-mode-tablet",function(j){g();d();e(".js-jportal-preview-mode-tablet").addClass("is-active");e(".jportal-preview-mode-rotate").removeClass("disabled");e("#jportalPreviewIframe").addClass("jportal-preview-mode-tablet");f()});e(document).on("click",".js-jportal-preview-mode-screen",function(j){g();d();e(".js-jportal-preview-mode-screen").addClass("is-active");e("#jportalPreviewIframe").addClass("jportal-preview-mode-screen");i()});e(document).on("click",".js-jportal-preview-mode-largescreen",function(j){g();d();e(".js-jportal-preview-mode-largescreen").addClass("is-active");e("#jportalPreviewIframe").addClass("jportal-preview-mode-largescreen");i()});e(document).on("click",".js-toggle-topbar",c);e("#jportalPreviewIframe").load(function(){const j=e(this).contents();let topbarOverlay=e(Handlebars.compile(e("#topbar-preview-overlay").html())());j.find(".topbar").prepend(topbarOverlay)})};const c=function(j){e(".jportal-preview").toggleClass("hide-topbar")};var f=function(){if(a!=null){a.update()}else{a=new PerfectScrollbar(e("#jportalPreviewIframe").contents().find("html")[0])}};var i=function(){if(a!=null&&a!=undefined){a.destroy();a=null}};var d=function(){e(".js-jportal-preview-mode-largescreen").removeClass("is-active");e(".js-jportal-preview-mode-screen").removeClass("is-active");e(".js-jportal-preview-mode-tablet").removeClass("is-active");e(".js-jportal-preview-mode-smartphone").removeClass("is-active")};var g=function(){e("#jportalPreviewIframe").removeClass("jportal-preview-mode-smartphone");e("#jportalPreviewIframe").removeClass("jportal-preview-mode-tablet");e("#jportalPreviewIframe").removeClass("jportal-preview-mode-screen");e("#jportalPreviewIframe").removeClass("jportal-preview-mode-largescreen");e(".jportal-preview-mode-rotate").addClass("disabled")};var b=function(m){try{var l=m.originalEvent.key;if(l=="jportal.sync.preview.structure"){var p=m.originalEvent.newValue;var k=JSON.parse(p);var n=e(".jportal-preview").data("jalios-jportal");if(k.jportal==n){e("BODY").addClass("jportal-overlay-active");var j=e(".jportal-overlay");j.removeClass("hide").addClass("is-active");e("#jportalPreviewIframe").one("load",function(){e("BODY").removeClass("jportal-overlay-active");var q=e(".jportal-overlay");q.one(e.support.transition.end,function(){q.addClass("hide")});q.removeClass("is-active")});e("#jportalPreviewIframe").attr("src",e("#jportalPreviewIframe").attr("src"))}}}catch(o){}};e(document).ready(function(){h()})})(window.jQuery);