!(function(a){a(document).on("input propertychange",".smartphone-wiki-area",function(i){var f=i.target;if(f.classList.contains("publication-link-disabled")){return}if(f.selectionStart>f.selectionEnd){return}var j=f.selectionStart;var c=f.selectionEnd;var g=f.value;if(j==c){j--}var d=g.charAt(j);while(j>=0&&d!=" "&&d!="\n"&&d!="\r"){j--;d=g.charAt(j)}var h=g.substring(j+1,c);if(h&&h.length===2&&h.indexOf(" ")<0&&h.indexOf("[[")===0){a.jalios.smartPhone.DataChooser.createChooser("publication-link-chooser","");var b=a(".chooser-form");b.data("chooser-type","publication");b.data("selection-end",c);b.data("caller-input",a(i.target));b.data("replaced-word",h);a(".chooser-input").trigger("input")}});a(document).on("click",".publication-link-chooser .chooser-close",function(){var b=a(".chooser-form");var c=b.data("caller-input");var d=b.data("selection-end");if(c.length>=1){c.get(0).setSelectionRange(d,d);c.focus()}a.jalios.smartPhone.DataChooser.desactivateChooser()});a(document).on("click",".publication-link-chooser .chooser-result",function(h){var l=a(".chooser-form");var i=l.data("caller-input");var f=a(h.target).closest(".chooser-result").data("jalios-chooser-dataid")+"]["+a(h.target).closest(".chooser-result").data("jalios-chooser-label")+"]]";var d=l.data("replaced-word");var k=l.data("selection-end");var g=k-d.length+2;var i=l.data("caller-input");a.jalios.smartPhone.DataChooser.desactivateChooser();if(i.length>=1){if(i.get(0).setRangeText){i.get(0).setRangeText(f,g,k)}else{var b=i.val();var c=b.substring(0,g)+f+b.substring(k);i.val(c)}var j=k+(f.length-d.length+2);i.get(0).setSelectionRange(j,j);i.focus()}})})(window.jQuery);