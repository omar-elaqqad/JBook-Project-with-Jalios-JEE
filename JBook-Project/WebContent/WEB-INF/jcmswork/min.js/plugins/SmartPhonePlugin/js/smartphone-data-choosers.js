!(function(a){if(!a.jalios){a.jalios={}}if(!a.jalios.smartPhone){a.jalios.smartPhone={}}a.jalios.smartPhone.DataChooser={createChooser:function(c,b){var f={member:"plugins/SmartPhonePlugin/jsp/action/chooser/acMember.jsp",group:"plugins/SmartPhonePlugin/jsp/action/chooser/acGroup.jsp",publication:"plugins/SmartPhonePlugin/jsp/action/chooser/acPublication.jsp",category:"plugins/SmartPhonePlugin/jsp/action/chooser/acCategory.jsp",workspace:"plugins/SmartPhonePlugin/jsp/action/chooser/acWorkspace.jsp"};var d=a(".ui-page-active").is(".scrolling-touch");var e=false;if(typeof c!=="string"){c=""}else{c=" "+c}if(typeof b!=="string"){b=""}a(".ui-page-active").append('<form class="chooser-form'+c+'" autocomplete="off">  <div class="chooser">    <div class="chooser-input-wrapper">      <input name="q" class="chooser-input" data-role="none">      <a href="#" class="chooser-close ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all" title="Clear text">Clear text</a>    </div>    <div class="chooser-results-wrapper">      <ul class="chooser-results ui-listview ui-listview-full-abstract ui-listview-full ui-listview-enhanced" data-enhance="false" data-role="listview"></ul>    </div>  </div></form>');a("BODY").on("scroll touchmove mousewheel",function(g){if(a(g.target).closest(".chooser-results").length>0){return}g.preventDefault();g.stopPropagation();return false});a("BODY").css("overflow","hidden");a(".chooser-input").focus().val(b);if(d){a(".ui-page-active").removeClass("scrolling-touch")}a(".chooser-input").on("input propertychange",function(i){var h=a(i.target).closest("FORM");var j=a.jalios.smartPhone.Ajax.resolveParams(undefined,h);var g=true;if(j instanceof FormData){g=false}a(".ui-loader").loader("show");if(e){clearTimeout(e)}e=setTimeout(function(){a.ajax(f[h.data("chooser-type")],{data:j,processData:g,contentType:a.jalios.smartPhone.Ajax.resolveAjaxRefreshContentType(g),type:a.jalios.smartPhone.Ajax.resolveMethod(undefined,h),success:function(k){a(".chooser-results").empty().append(k);a(".ui-loader").loader("hide")},error:function(){a(".chooser-results").empty();a(".ui-loader").loader("hide")}});e=false},250)})},desactivateChooser:function(){a(".chooser-form").remove();a("BODY").off("scroll touchmove mousewheel");a("BODY").css("overflow","");if(typeof scrollingTouch!=="undefined"){a(".ui-page-active").addClass("scrolling-touch")}}};a(function(){var b=function(c){c.find(".choosen-selected-id").val("");c.find(".input-with-chooser").val("");c.find(".ui-input-clear").remove();c.find(".ui-input-text").removeClass("ui-input-has-clear")};a(document).on("click",".input-with-chooser",function(h){h.stopPropagation();a.jalios.smartPhone.DataChooser.createChooser("autocomplete-chooser");var g=a(h.target);var c=a(".chooser-form");c.data("caller-input",g);c.data("chooser-type",g.data("chooser-type"));var f=g.data("jalios-ac-options");var d;if(f){d=f.replace(/\?/,"").split("&");a.each(d,function(j,e){e=e.split("=");c.append('<input type="hidden" name="'+e[0]+'" value="'+e[1]+'" />')})}});a(document).on("click",".autocomplete-chooser .chooser-close",a.jalios.smartPhone.DataChooser.desactivateChooser);a(document).on("click",".autocomplete-chooser .chooser-result",function(g){var d=a(".chooser-form").data("caller-input");var f=d.closest(".input-with-chooser-wrapper");f.find(".input-with-chooser").val(a(g.target).closest(".chooser-result").data("jalios-chooser-label"));f.find(".choosen-selected-id").val(a(g.target).closest(".chooser-result").data("jalios-chooser-dataid"));a.jalios.smartPhone.DataChooser.desactivateChooser();if(!d.parent().hasClass("ui-input-has-clear")){d.after('<a href="#" tabindex="-1" aria-hidden="true" class="ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all" title="Clear text">Clear text</a>');d.parent().addClass("ui-input-has-clear")}var c=d.closest(".jalios-input-group");if(d.closest(".multivalued").length!==0&&c.is(":last-child")){var h=c.clone();b(h.find(".input-with-chooser-wrapper"));c.after(h)}});a(document).on("click",".input-with-chooser-wrapper .ui-input-clear",function(d){var c=a(d.target).closest(".jalios-input-group");if(c.is(":last-child")){b(a(d.target).closest(".input-with-chooser-wrapper"))}else{c.remove()}})})})(window.jQuery);